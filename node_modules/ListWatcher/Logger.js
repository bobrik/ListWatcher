var fs      = require("fs");
var path    = require("path");
var moment  = require("moment");


module.exports = {

    LOG_DIR: "log",

    LOG_EXTENSION: ".log",

    create: function(type) {
        var self = Object.create(this);

        self.setType(type);
        self.init();

        return self;
    },

    setType: function(type) {
        this.type = type;
    },

    getType: function() {
        return this.type;
    },

    init: function() {
        this.stream = fs.createWriteStream(this.getFileName());
    },

    getFileName: function() {
        return path.join(this.LOG_DIR, this.getType() + this.LOG_EXTENSION);
    },

    getLinePrefix: function() {
        return moment().format("[YYYY-MM-DD HH:mm:ss] ");
    },

    write: function(message) {
        this.stream.write(this.getLinePrefix() + message + (message.stack ? "\n" + message.stack : "") + "\n")
    }

};
